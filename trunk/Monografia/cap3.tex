\chapter{Modelo proposto}\label{cap:som}

Este trabalho visa apresentar um modelo para recomendação de filmes para clientes no ambiente de vídeo locadoras. O modelo proposto utiliza as redes SOM como descritas por Kohonen \cite{Kohonen1989} para aprender o comportamento do usuário e auxiliá-lo na escolha do filme.

Após a descrição dos conceitos e algoritmos apresentados no capítulo 2, será apresentado neste capítulo a contribuição do modelo proposto.

\section{Visão Geral}
O modelo para recomendação escolhido leva em consideração a limitação das vídeos locadoras no que tange aos conceitos gerais de sistemas de recomendação comuns. As informações que estão disponíveis num ambiente de locadora de filmes consideram somente o cliente como indivíduo e não um grupo de clientes que podem contribuir juntamente para gerar recomendações. Portanto não há o conceito de avaliação de um item pelo usuário. Nos sistemas de locadoras comuns não existe um mecanismo onde o cliente possa dar sua nota para um filme de forma que outros clientes possam acompanhar essas avaliações e ter um parâmetro para a escolha de determinado título. Existe apenas a opinião ''de boca'' de clientes que queiram expressar ou quando o funcionário da loja educadamente questiona sobre a satisfação do cliente com relação a determinado filme. Nenhuma informação é armazenada num banco de dados, nem é realizado um levantamento das opiniões de diversos clientes, com o propósito de identificar os melhores filmes.

A proposta deste trabalho é desenvolver um sistema que, baseado no histórico de locações de um cliente, possa conduzí-lo a uma escolha satisfatória no momento de locar um novo título. O sistema se baseia somente no conteúdo dos filmes que já foram locados por um determinado cliente, informações que podem ser facilmente obtidas no banco de dados da locadora. Como mencionado anteriormente, não existem avaliações de clientes sobre os filmes nem parâmetros que determinem as preferências desses clientes. Portanto, o modelo proposto não ambiciona gerar uma lista de recomendações diretas com títulos para o cliente, apenas auxiliá-lo de forma a realizar uma escolha consciente baseado nas informações contidas nos filmes. O modelo utiliza redes auto-organizáveis pois este algoritmo desempenha bem a função de agrupamento e vizinhança, para que o cliente tenha uma percepção melhor da relação entre os filmes que este já assistiu com os que deseja locar no momento. O objetivo específico do trabalho é realizar uma prova de conceito para o uso de redes SOM na recomendação de filmes a ser implementado em vídeo locadoras como forma de personalização da loja para o cliente, tornando mais prazeroso e simplificado o ato da escolha do filme a ser locado. A personalização torna o cliente mais satisfeito e mais assíduo, podendo ser uma ferramenta no combate à pirataria.

O modelo proposto consiste em uma rede SOM composta por filmes contidos no histórico de um cliente. Existe, portanto, um mapa SOM para cada cliente. A rede irá distribuir os títulos em um mapa bidimensional, agrupando-os de acordo com semelhanças entre informações fornecidas sobre os filmes. Nesta fase ocorre o aprendizado do comportamento do cliente com relação às escolhas de filmes. 

Após o treinamento da rede, os filmes locados por um cliente estarão distribuídos no mapa. O cliente deve, então selecionar um filme do acervo da locadora e apresentar ao seu mapa individual. A rede irá calcular a posição deste novo filme e irá mostrar ao usuário 3 filmes que estejam próximos àquele, determinando que há semelhanças entre esses quatro títulos. Esta é uma forma de auxiliar o cliente, pois ele pode avaliar se irá gostar ou não do filme, partindo da satisfação que teve ao assistir os outros três. 

\section{Implementação do modelo}
A implementação da rede SOM utilizada no modelo deste trabalho foi feita baseada no algoritmo original proposto por Kohonen, como descrito no Capítulo 2. A linguagem utilizada para desenvolvimento foi C\# com o \reg{Microsoft} \reg{Visual Studio} 2008 como IDE de programação. A escolha desta tecnologia se justifica por ser uma linguagem de fácil implementação e ser mais largamente utilizada pelo autor deste trabalho. A Figura \ref{DiagramaClasses} mostra os diagramas de classes do modelo implementado. MapaSOM é uma classe que comporta todos os neurônio da rede e recebe o conjunto de entradas para ser apresentado durante o treinamento. Cada neurônio possui coordenadas $x$ e $y$, determinando sua posição no reticulado do mapa e o vetor de pesos que são inicializados aleatoriamente e ajustados durante a fase de aprendizado. Cada padrão de entrada tem um conjunto de características que são extraídos do banco de dados de filmes, além de um objeto neurônio que caracteriza o neurônio vencedor para representar o padrão.

\begin{figure}[htbp]
	\centering
		\includegraphics[width=1.00\textwidth]{../DiagramaClasses.jpg}
	\caption{Diagrama de classes do modelo}
	\label{DiagramaClasses}
\end{figure}

\section{Funcionamento do modelo}

O algoritmo inicia obtendo os padrões de entrada a serem utilizados na fase de treinamento e determinando o tamanho do mapa, ou seja, o número de neurônios presentes na rede. Em seguida, é inicializado o vetor de pesos de cada neurônio e determinado o raio de vizinhança inicial. Empiricamente, um valor inicial adequado para a vizinhança é de 60\% do tamanho total do mapa. Os pesos dos neurônios são inicializados com valores aleatórios.

Após a fase de inicialização do mapa, segue-se a fase de aprendizado ou treinamento. A fase de treinamento inicia ao serem apresentados à rede os padrões de entrada. Então é calculado o neurônio que mais se aproxima de cada padrão, determinado o neurônio vencedor. O cálculo para determinar o neurônio vencedor segue a função da distância euclidiana como foi descrito no Capítulo 2. Os pesos do neurônio selecionado são atualizados, assim como os pesos de neurônios em sua vizinhança. Esses passos são repetidos até que o número determinado de ciclos seja alcançado. No final da fase de treinamento todos os filmes presentes no histórico do cliente estão distribuídos topologicamente no mapa que representa, então, o perfil do usuário.

Com a rede treinada, inicia-se a fase de teste. Neste passo serão mostrados novos títulos de filmes à rede, representando filmes que o cliente deseja alugar. Ao ser apresentado a um novo padrão, a rede irá calcular o neurônio que melhor representa este padrão, da mesma maneira que é realizado na fase de aprendizado. A diferença aqui está em que os pesos do neurônio vencedor não serão mais ajustados. O ajuste de pesos é que caracteriza o aprendizado da rede, portanto nesta fase não é realizado o cálculo de ajuste e de vizinhança.

Após o cálculo do neurônio vencedor, o algoritmo irá determinar quais são os três neurônios mais próximos daquele. Para isso é calculada a distância entre dois pontos no plano bidimensional. Os três neurônios mais próximos do vencedor representam padrões de entrada que são os filmes que mais se assemelham ao filme representado pelo neurônio vencedor. O sistema então auxilia o cliente na decisão mostrando que o filme que ele deseja locar tem relação de semelhança com outros três que ele já locou no passado. Dependendo da satisfação do usuário com os três filmes que foram mostrados, ele decide se irá mesmo locar o filme escolhido ou não.